# 变更记录：搜索/转写/可视化交互与本地构建修复

## 当初需求
- 统一 Search/Transcriptions/About 的视觉风格与排版节奏（更轻、更呼吸）。
- Visualization 添加交互（缩放控件、鼠标反馈），并修复“显示乱码/CSV 解析问题”。
- 暂时取消卡片跳转，但保持可视化可用。

## 识别出的问题与原因
- **可视化 CSV 解析错误**：原先用 `split(",")` 解析，遇到带逗号的字段会列错位，导致标签“乱码”。
- **本地无法启动**：
  - `str.startsWith is not a function`：分页 `pagination.data` 使用了数组，Eleventy v3 在依赖图中期望字符串路径。
  - `Could not find pagination data: cards`：全局数据目录设置为 `src/data/`，而数据文件放在 `src/_data/`。
  - `DuplicatePermalinkOutputError`：多个节点复用相同 `cardURL`（如 `/cards/9.html`），导致输出冲突。
- **交互不符合预期**：
  - hover 反馈过于“硬”，希望改成位移/波动而非突然变大或加粗。
  - idle 浮动容易卡顿、视觉不顺。

## 解决方案与改动
- **CSV 解析改为支持引号内逗号**，避免字段错位。
- **分页数据接入 Eleventy 规范**：
  - `pagination.data` 改为字符串引用（`"cards"`）。
  - `cards` 全局数据迁移到 `src/data/cards.js`（与项目配置一致）。
  - 为重复 `cardURL` 设定回退逻辑，避免重复输出。
- **可视化交互**：
  - 移除跳转，保留高亮与 hover 波动。
  - 加入缩放控件（右上角 hover 出现）。
  - hover 改为“位移涟漪”而非大小/字体突变。
  - 取消 idle 漂浮，避免卡顿感。
- **搜索与转写页面风格调整**：
  - 移除 emoji、统一字体与排版层级。
  - 细化阴影/浮雕，让控件更有呼吸感。
  - 统一浅色底与卡片质感。

## 经验教训
- **Eleventy 分页要用数据键名，不要直接传数组**。
- **全局数据目录要与 `dir.data` 一致**（本项目为 `src/data/`）。
- **CSV 解析必须考虑引号与逗号**，否则可视化会出现“乱码/错位”。
- **交互尽量避免硬切换（突然变粗/变大）**，可通过位移或柔和阴影增强体验。
- **视觉动效应以“轻微、可感知但不扰动阅读”为原则**。
